M1.2: Advanced SQL Exam

Question 1. **Which of the following statements is true about a left join in SQL?**

<br/>

A. A left join returns all rows from both tables where the join condition is true.

B. A left join returns all rows from the left table and matching rows from the right table.

C. A left join returns all rows from the right table and matching rows from the left table.

Question 2. **What happens if there is no matching row in the right table in a left join?**

<br/>

A. The join fails and no rows are returned.

B. The join includes a null value for the columns from the right table.

C. The join only returns rows from the left table.

Question 3. **What does a full outer join return in SQL?**

<br/>

A. All rows from both tables where the join condition is true.

B. All rows from the left table and matching rows from the right table.

C. All rows from the right table and matching rows from the left table.

D. All rows from both tables, including unmatched rows.

Question 4. **What is the purpose of a self join in SQL?**

<br/>

A. To join a table with itself to create a new table.

B. To compare rows within a table based on a certain condition.

C. To filter out rows in a table based on a certain condition.

D. To improve the performance of a query by reducing the number of joins.

Question 5. **What is the difference between a UNION and an INTERSECT operation in SQL?**

<br/>

A. A UNION operation combines the results of two or more SELECT statements, while an INTERSECT operation returns only the rows that are common to both SELECT statements.

B. A UNION operation returns only the rows that are common to both SELECT statements, while an INTERSECT operation combines the results of two or more SELECT statements.

C. A UNION operation returns all the rows from both SELECT statements, while an INTERSECT operation returns only the distinct rows that are common to both SELECT statements.

D. A UNION operation returns only the distinct rows from both SELECT statements, while an INTERSECT operation returns all the rows that are common to both SELECT statements.

Question 6. **Which of the following statements is true about the COALESCE function in SQL?**

<br/>

A. It can only be used with numeric data types.

B. It always returns a null value if all expressions are null.

C. It only works with two expressions at a time.

D. It can be used with any data type.

Question 7. **What does the ROUND(x, n) function do in SQL?**

<br/>

A. It rounds the number x down to the nearest integer.

B. It rounds the number x up to the nearest integer.

C. It rounds the number x to n number of decimal places.

D. It returns the smallest integer greater than or equal to the number x.

Question 8. **Which of the following statements is true about the LEFT and RIGHT functions in SQL?**

<br/>

A. Both functions can be used to replace a specified substring in a string.

B. Both functions return the entire string if the specified length is greater than the length of the string.

C. The LEFT function can only be used with numeric data types.

D. The RIGHT function can only be used with character data types.

Question 9. What is the result of using arithmetic operators with NULL values in SQL?

<br/>

A. An error message is returned.

B. The result is always NULL.

C. The NULL value is treated as zero.

D. The NULL value is treated as one.

Question 10. **Which of the following SQL statements correctly uses the LAG() function to return the previous row's value of the 'sales' column in the 'orders' table?**

<br/>

A. `SELECT LAG(sales) OVER (ORDER BY date) as prev_sales, sales FROM orders;`

B. `SELECT LAG(sales, 1) OVER (ORDER BY date) as prev_sales, sales FROM orders;`

C. `SELECT LAG(sales, 1, 0) OVER (ORDER BY date) as prev_sales, sales FROM orders;`

D. `SELECT LAG(sales, -1) OVER (ORDER BY date) as prev_sales, sales FROM orders;`

Question 11. **List all tracks along with their album from The Rolling Stones.**

 Order by albumn titles and track names.

<br/>

_Expected output_: There must be 41 rows in the output.

 <img width='600' src='https://i.imgur.com/xFAfJXy.png'>

Question 12. **Retrieve the total number of tracks in each playlist.**

 Order by number of tracks in descending order.

<br/>

_Expected output_:

 <img width='600' src='https://i.imgur.com/BNNYZrz.png'>

Question 13. **Find the total revenue generated by each album.**

 Order by total revenue in descending order.

<br/>

_Expected output_:

 <img width='600' src='https://i.imgur.com/kWXuavI.png'>

Question 14. **Find the number of invoices generated each year.**

 Order the result by year.

<br/>

_Expected output_:

 <img width='600' src='https://i.imgur.com/YDZnIYh.png'>

Question 15. **Find customers that spend over $40 at Chinook store.**

 Display their full name and order by the total sales in descending order.

<br/>

_Expected output_:

 <img width='600' src='https://i.imgur.com/4E8bNWK.png'>

Question 16. **Find the managers and the number of employees they manage in the store.**

 Display their fullname and order alphabetically.

<br/>

_Expected output_:

 <img width='600' src='https://i.imgur.com/5ZO7b7k.png'>

Question 17. **Calculate the cumulative sales for each customer.** E.g. If a customer has three invoices with totals of 50, 30, and 20, the cumulative sales after the 3rd invoice would be: 50 + 30 + 20 = 100

 Display their fullname and order by customer id and invoice date.

<br/>

_Expected output_:

 <img width='600' src='https://i.imgur.com/stM7l95.png'>

Question 18. **Rank the albums by their total sales revenue.**

 Display the album's id, title and order by their ranking.

<br/>

_Expected output_:

 <img width='600' src='https://i.imgur.com/FZcMa9T.png'>

Question 19. **Find the total amount that each customer spent each month.**

 Display their full name and order by customer name and month

<br/>

_Expected output_:

 <img width='600' src='https://i.imgur.com/ivuvPEc.png'>

Question 20. **Find the total amount each customer spent each month. Include only customers who spent more than $45.**

Display their full name and order the results by customer name and month

<br/>

_Expected output_: There must be total **35 rows** in the output

 <img width='600' src='https://i.imgur.com/afqIXrv.png'>